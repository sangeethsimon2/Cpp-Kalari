This version is O(N^3) complexity.

